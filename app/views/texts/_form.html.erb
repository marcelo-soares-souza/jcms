<%= javascript_include_tag "/js/tinymce/tiny_mce.js" %>
<%= javascript_include_tag "/js/tinymce/jquery.tinymce.js" %>

<%= javascript_tag do %>
$().ready(function() {
  $('textarea.tinymce').tinymce({
    script_url : '/js/tinymce/tiny_mce.js',
    theme : "advanced",
    theme_advanced_toolbar_location : "top",
    theme_advanced_toolbar_align : "left",
    theme_advanced_statusbar_location : "bottom",
    theme_advanced_resizing : true,
    width : "800",
    height : "400"
  
  });
});
<% end %>

<% if params[:action] != 'edit' %>
  <% @text.contents.build %>
<% end %>

<%= form_for @text, :html => { :class => "form-stacked" } do |f| %>
  <% if @text.errors.any? %>
      <div class="alert-message alert">
      <h2><%= pluralize(@text.errors.count, t('Error')) %></h2>
      <ul>
      <% @text.errors.full_messages.each do |msg| %>
        <li><strong><%= msg %></strong></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <fieldset>
    <div class="clearfix">
      <%= f.label :title %>
      <div class="input">
        <%= f.text_field :title %>
      </div>
    </div>

    <div class="clearfix">
      <%= f.label :abstract %>
      <div class="input">
        <%= f.text_field :abstract, :class => 'span10' %>
      </div>
    </div>

    <div class="clearfix">
      <%= f.label :license %>
      <div class="input">
        <%= f.select( :license_id, @licenses.collect { |l| [l.name, l.id] } ) %>
      </div>
    </div>

    <div class="clearfix">
      <%= f.label :publish %>
      <div class="input">
        <%= f.check_box :publish %>
      </div>
    </div>

    <div class="clearfix">
      <%= f.label :firstpage %>
      <div class="input">
        <%= f.check_box :firstpage %>
      </div>
    </div>

    <div class="clearfix">
      <%= f.label :body %>
      <div class="input">
        <%= f.text_area :body, :class => "tinymce" %>
      </div>
    </div>

    <%= render :partial => 'contents/form', :locals => {:form => f} %>

    <div class="actions">
      <%
        if params[:action] == 'edit'
          type = 'btn success'
        else
          type = 'btn primary'
        end
      %>

      <%= f.submit 'class' => type %>
      <% if params[:action] == 'edit' %>
        <%= link_to_if (params[:action] == 'edit', t('Delete'), @text, :class => 'btn danger', :confirm => t('Are you sure?'), :method => :delete) %>
      <% end %>
    </div>

  </fieldset>
<% end %>
